# RunNode External Interface 环境变量配置指南

本文档列出了 RunNode External Interface 插件支持的所有配置类环境变量。这些变量主要用于控制插件的行为、日志记录、API 连接以及特定功能的开关。

**注意**：本文档不包含 Python 依赖库（如 `PYTHONPATH`, `CUDA_VISIBLE_DEVICES` 等）的环境变量。

## 🛡️ 安全与隐私

| 环境变量名 | 默认值 | 描述 |
| :--- | :--- | :--- |
| `RUNNODE_HIDE_URL_HOSTS` | `true` | **敏感信息隐藏开关**。<br>设置为 `true` (默认) 时，插件会在日志和错误信息中自动隐藏 URL 中的主机名 (host) 和端口，以防止敏感的内部地址泄露。<br>设置为 `false` 可关闭此功能，显示完整 URL（仅建议调试时使用）。 |

## 📝 日志与调试

| 环境变量名 | 默认值 | 描述 |
| :--- | :--- | :--- |
| `RUNNODE_LOG_LEVEL` | `INFO` | **日志级别**。<br>可选值：`DEBUG`, `INFO`, `WARNING`, `ERROR`, `CRITICAL`。<br>用于控制控制台输出的详细程度。 |
| `RUNNODE_STREAMING_PROGRESS` | `true` | **流式进度条开关**。<br>设置为 `true` (默认) 时，会在控制台输出实时的任务进度百分比。<br>设置为 `false` 可减少控制台的刷屏信息。 |
| `RUNNODE_HEARTBEAT_LOG` | `true` | **心跳日志开关**。<br>设置为 `true` (默认) 时，对于长时间运行的任务（如视频生成），会定期输出心跳日志证明任务仍在运行。<br>设置为 `false` 可关闭心跳日志。 |
| `RUNNODE_HEARTBEAT_INTERVAL_SEC` | `15` | **心跳间隔时间**（秒）。<br>控制心跳日志输出的频率，默认为每 15 秒一次。 |

## 🔑 API 认证与连接 (全局)

这些变量用于覆盖配置文件 (`Comflyapi.json`) 中的全局设置。

| 环境变量名 | 描述 | 优先级 |
| :--- | :--- | :--- |
| `COMFLY_API_KEY`<br>`COMFYUI_RN_API_KEY`<br>`RUNNODE_API_KEY`<br>`RN_API_KEY` | **全局 API Key**。<br>用于所有服务的默认认证密钥。 | 高于配置文件 |
| `COMFLY_BASE_URL`<br>`COMFYUI_RN_BASE_URL`<br>`RUNNODE_BASE_URL`<br>`RN_BASE_URL` | **全局 Base URL**。<br>API 请求的基础地址（中转地址）。 | 高于配置文件 |
| `COMFLY_MODEL`<br>`COMFYUI_RN_MODEL`<br>`RUNNODE_MODEL`<br>`RN_MODEL` | **全局默认模型**。<br>未指定模型时使用的默认模型名称。 | 高于配置文件 |

## ⚙️ 生成参数默认值

| 环境变量名 | 默认值 | 描述 |
| :--- | :--- | :--- |
| `COMFLY_TEMPERATURE`<br>`COMFYUI_RN_TEMPERATURE` | `0.7` | **默认温度 (Temperature)**。<br>控制生成的随机性。 |
| `COMFLY_MAX_TOKENS`<br>`COMFYUI_RN_MAX_TOKENS` | `1000` | **默认最大 Token 数**。<br>控制生成的最大长度。 |
| `COMFLY_TOP_P`<br>`COMFYUI_RN_TOP_P` | `0.9` | **默认 Top-P**。<br>控制核采样阈值。 |

## 🎬 Sora2 专属配置

用于精细控制 Sora2 视频生成服务的行为。

| 环境变量名 | 描述 |
| :--- | :--- |
| `SORA2_PRIORITIZE_V1`<br>`COMFLY_SORA2_PRIORITIZE_V1` | **优先使用 V1 接口**。<br>设置为 `true` 时，Sora2 节点将优先尝试调用旧版 V1 接口。 |
| `SORA2_BASE_URL`<br>`COMFLY_SORA2_BASE_URL` | **Sora2 专属 Base URL**。<br>仅针对 Sora2 任务生效的接口地址。 |
| `SORA2_API_KEY`<br>`COMFLY_SORA2_API_KEY` | **Sora2 专属 API Key**。<br>仅针对 Sora2 任务生效的密钥。 |
| `SORA2_NEW_BASE_URL`<br>`COMFLY_SORA2_NEW_BASE_URL` | **Sora2 新版接口 Base URL**。<br>用于 Sora2 新版协议的接口地址。 |
| `SORA2_NEW_API_KEY`<br>`COMFLY_SORA2_NEW_API_KEY` | **Sora2 新版接口 API Key**。<br>用于 Sora2 新版协议的密钥。 |

## 🚀 配置生效顺序

系统按照以下优先级顺序读取配置（由高到低）：

1.  **节点面板输入** (在 ComfyUI 界面上直接填写的参数)
2.  **环境变量** (本文档列出的变量)
3.  **配置文件** (`config/Comflyapi.json` 或 `config/*config*.json`)
4.  **代码硬编码默认值**

---
*Generated by RunNode Team*
